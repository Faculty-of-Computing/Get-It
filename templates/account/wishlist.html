{% extends "base.html" %}
{% block content %}
<div class="container">
    <h2>My Wishlist</h2>
    <div class="products-grid">
        {% if products and products|length > 0 %}
        {% for product in products %}
        <div class="product-card">
            <a href="{{ url_for('product.product_detail', product_id=product.id) }}" class="img-container"
                style="display:block;">
                <img src="{{ product.images[0]|default(url_for('static', filename='default_profile.svg')) }}"
                    alt="{{ product.name }}" style="width:100%;height:180px;object-fit:cover;border-radius:8px;">
            </a>
            <h3 style="margin:0.5em 0 0.2em 0;font-size:1.1em;">{{ product.name }}</h3>
            <p style="margin:0 0 0.5em 0;font-weight:bold;">â‚¦{{ "%.2f"|format(product.price) }}</p>
            <form method="post" action="{{ url_for('cart.add_to_cart', product_id=product.id) }}"
                style="margin-bottom:0.5em;">
                <button type="submit" class="btn-2">Add to Cart</button>
            </form>
            <button class="wishlist-btn" onclick="removeFromWishlist({{ product.id }})" title="Remove from Wishlist"
                style="background:none;border:none;cursor:pointer;">
                <i class="fa fa-heart" style="color:#b88346;font-size:1.5em;"></i>
            </button>
        </div>
        {% endfor %}
        {% else %}
        <div style="text-align:center;padding:3em 0;">
            <img src="{{ url_for('static', filename='default_profile.svg') }}" alt="Empty Wishlist"
                style="width:80px;height:80px;opacity:0.5;margin-bottom:1em;">
            <h4>Your wishlist is empty.</h4>
            <p>Browse products and click the heart icon to save your favorites here.</p>
            <a href="{{ url_for('home') }}" class="btn">Continue Shopping</a>
        </div>
        {% endif %}
    </div>
</div>
<script>
    function removeFromWishlist(productId) {
        fetch(`/wishlist/remove/${productId}`, { method: 'POST' })
            .then(res => res.json())
            .then(data => {
                if (data.success) location.reload();
                else alert(data.message);
            });
    }
</script>
{% endblock %}